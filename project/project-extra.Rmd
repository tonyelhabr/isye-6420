
The next couple of visuals provide more details regarding the simulated outcomes.

```{r path_viz_g_mode}
path_viz_g_mode <- 'viz_g_mode.png'
eval_viz_g_mode <- !fs::file_exists(path_viz_g_mode)
.lab_caption_n_gm <- glue::glue('Total games: {n_gm}.')
```

```{r viz_g_mode-appendix}
viz_g_mode <-
  preds_tidy_aug %>% 
  filter(key %>% str_detect('^g.*mode$')) %>% 
  ggplot() +
  aes(x = value, fill = key_lab) +
  scale_fill_brewer(palette = 'Set1') +
  geom_bar(position = 'dodge', alpha = 0.8) +
  theme_custom() +
  theme(
    panel.grid.major.x = element_blank()
  ) +
  labs(
    title = 'Simulated Mode of Goals Scored By Home and Away Teams',
    subtitle = .lab_subtitle,
    caption = .lab_caption_n_gm,
    x = 'Goals Scored',
    y = 'Count of Games'
  )
viz_g_mode
```

```{r viz_g_mode_export, eval=eval_viz_g_mode}
export_png(
  viz_g_mode,
  path = path_viz_g_mode,
)
```

```{r viz_g_mode-show, include=T, fig.show='asis'}
viz_g_mode
```

From the above graph of the mode of goals scored by both sides, it's apparent that a 2-1 scores in favor of the home side is the most common outcome.

```{r path_viz_g_mean}
path_viz_g_mean <- 'viz_g_mean.png'
eval_viz_g_mean <- !fs::file_exists(path_viz_g_mean)
```

```{r viz_g_mean-appendix}
viz_g_mean <-
  preds_tidy_aug %>% 
  # This is done so that the `aes()` can be defined before data is actually passed into the whole ggplot pipeline.
  filter(row_number() == 0) %>% 
  ggplot() +
  aes(x = value, fill = key_lab) +
  scale_fill_brewer(palette = 'Set1') +
  geom_histogram(data = filter(preds_tidy_aug, key == 'g_h_mean'), alpha = 1, binwidth = 0.2) +
  geom_histogram(data = filter(preds_tidy_aug, key == 'g_a_mean'), alpha = 0.5, binwidth = 0.2) +
  theme(
    panel.grid.major.x = element_blank()
  ) +
  theme_custom() +
  labs(
    title = 'Simulated Mean of Goals Scored By Home and Away Teams',
    subtitle = .lab_subtitle ,
    caption = .lab_caption_n_gm,
    x = 'Goals Scored',
    y = 'Count of Games'
  )
viz_g_mean
```

```{r viz_g_mean_export, eval=eval_viz_g_mean}
export_png(
  viz_g_mean,
  path = path_viz_g_mean,
)
```

```{r viz_g_mean-show, include=T, fig.show='asis'}
viz_g_mean
```

The above histogram illustrating the mean (instead of the mode) of the simulated goals provides a bit more nuance to our understanding of modes shown before.

```{r path_viz_result_mode}
path_viz_result_mode <- 'viz_result_mode.png'
eval_viz_result_mode <- !fs::file_exists(path_viz_result_mode)
```

```{r viz_result_mode-appendix}
preds_tidy_res <-
  preds_tidy %>% 
  filter(key == 'res_mode') %>% 
  mutate_at(
    vars(value),
    list(value_lab = ~case_when(
      . == 1 ~ 'Home Team Wins',
      . == 0 ~ 'Draw',
      . == -1 ~ 'Away Team Wins'
    ))
  ) %>% 
  mutate_at(vars(value_lab), ~forcats::fct_reorder(., value))
preds_tidy_res %>% count(value_lab)

viz_result_mode <-
  preds_tidy %>% 
  filter(key == 'result_mode') %>% 
  mutate_at(
    vars(value),
    list(value_lab = ~case_when(
      . == 1 ~ 'Home Team Wins',
      . == 0 ~ 'Draw',
      . == -1 ~ 'Away Team Wins'
    ))
  ) %>% 
  mutate_at(vars(value_lab), ~forcats::fct_reorder(., value)) %>% 
  ggplot() +
  aes(x = value_lab) +
  geom_bar(position = 'dodge') +
  theme_custom() +
  theme(
    panel.grid.major.x = element_blank()
  ) +
  labs(
    title = 'Simulated Result of Games',
    subtitle = .lab_subtitle ,
    caption = .lab_caption_n_gm,
    x = NULL,
    y = 'Count of Games'
  )
viz_result_mode
```

```{r viz_result_mode_export, eval=eval_viz_result_mode}
export_png(
  viz_result_mode,
  path = path_viz_result_mode,
)
```

```{r viz_result_mode-show, include=T, fig.show='asis', fig.width=8, fig.height=4}
viz_result_mode
```

Finally, the above visual shows the predicted outcomes (inferred from the prior graph of predicted modes). 
